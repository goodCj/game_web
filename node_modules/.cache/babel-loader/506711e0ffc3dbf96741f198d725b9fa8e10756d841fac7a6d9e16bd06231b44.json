{"ast":null,"code":"import _toConsumableArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport { useRef } from 'react';\nimport useUpdateEffect from '../../../useUpdateEffect';\n// support refreshDeps & ready\nvar useAutoRunPlugin = function useAutoRunPlugin(fetchInstance, _ref) {\n  var manual = _ref.manual,\n    _ref$ready = _ref.ready,\n    ready = _ref$ready === void 0 ? true : _ref$ready,\n    _ref$defaultParams = _ref.defaultParams,\n    defaultParams = _ref$defaultParams === void 0 ? [] : _ref$defaultParams,\n    _ref$refreshDeps = _ref.refreshDeps,\n    refreshDeps = _ref$refreshDeps === void 0 ? [] : _ref$refreshDeps,\n    refreshDepsAction = _ref.refreshDepsAction;\n  var hasAutoRun = useRef(false);\n  hasAutoRun.current = false;\n  useUpdateEffect(function () {\n    if (!manual && ready) {\n      hasAutoRun.current = true;\n      fetchInstance.run.apply(fetchInstance, _toConsumableArray(defaultParams));\n    }\n  }, [ready]);\n  useUpdateEffect(function () {\n    if (hasAutoRun.current) {\n      return;\n    }\n    if (!manual) {\n      hasAutoRun.current = true;\n      if (refreshDepsAction) {\n        refreshDepsAction();\n      } else {\n        fetchInstance.refresh();\n      }\n    }\n  }, _toConsumableArray(refreshDeps));\n  return {\n    onBefore: function onBefore() {\n      if (!ready) {\n        return {\n          stopNow: true\n        };\n      }\n    }\n  };\n};\nuseAutoRunPlugin.onInit = function (_ref2) {\n  var _ref2$ready = _ref2.ready,\n    ready = _ref2$ready === void 0 ? true : _ref2$ready,\n    manual = _ref2.manual;\n  return {\n    loading: !manual && ready\n  };\n};\nexport default useAutoRunPlugin;","map":{"version":3,"names":["useRef","useUpdateEffect","useAutoRunPlugin","fetchInstance","_ref","manual","_ref$ready","ready","_ref$defaultParams","defaultParams","_ref$refreshDeps","refreshDeps","refreshDepsAction","hasAutoRun","current","run","apply","_toConsumableArray","refresh","onBefore","stopNow","onInit","_ref2","_ref2$ready","loading"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/ahooks/es/useRequest/src/plugins/useAutoRunPlugin.js"],"sourcesContent":["import { useRef } from 'react';\nimport useUpdateEffect from '../../../useUpdateEffect';\n// support refreshDeps & ready\nconst useAutoRunPlugin = (fetchInstance, {\n  manual,\n  ready = true,\n  defaultParams = [],\n  refreshDeps = [],\n  refreshDepsAction\n}) => {\n  const hasAutoRun = useRef(false);\n  hasAutoRun.current = false;\n  useUpdateEffect(() => {\n    if (!manual && ready) {\n      hasAutoRun.current = true;\n      fetchInstance.run(...defaultParams);\n    }\n  }, [ready]);\n  useUpdateEffect(() => {\n    if (hasAutoRun.current) {\n      return;\n    }\n    if (!manual) {\n      hasAutoRun.current = true;\n      if (refreshDepsAction) {\n        refreshDepsAction();\n      } else {\n        fetchInstance.refresh();\n      }\n    }\n  }, [...refreshDeps]);\n  return {\n    onBefore: () => {\n      if (!ready) {\n        return {\n          stopNow: true\n        };\n      }\n    }\n  };\n};\nuseAutoRunPlugin.onInit = ({\n  ready = true,\n  manual\n}) => {\n  return {\n    loading: !manual && ready\n  };\n};\nexport default useAutoRunPlugin;"],"mappings":";AAAA,SAASA,MAAM,QAAQ,OAAO;AAC9B,OAAOC,eAAe,MAAM,0BAA0B;AACtD;AACA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAIC,aAAa,EAAAC,IAAA,EAMjC;EAAA,IALJC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAAC,UAAA,GAAAF,IAAA,CACNG,KAAK;IAALA,KAAK,GAAAD,UAAA,cAAG,IAAI,GAAAA,UAAA;IAAAE,kBAAA,GAAAJ,IAAA,CACZK,aAAa;IAAbA,aAAa,GAAAD,kBAAA,cAAG,EAAE,GAAAA,kBAAA;IAAAE,gBAAA,GAAAN,IAAA,CAClBO,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,EAAE,GAAAA,gBAAA;IAChBE,iBAAiB,GAAAR,IAAA,CAAjBQ,iBAAiB;EAEjB,IAAMC,UAAU,GAAGb,MAAM,CAAC,KAAK,CAAC;EAChCa,UAAU,CAACC,OAAO,GAAG,KAAK;EAC1Bb,eAAe,CAAC,YAAM;IACpB,IAAI,CAACI,MAAM,IAAIE,KAAK,EAAE;MACpBM,UAAU,CAACC,OAAO,GAAG,IAAI;MACzBX,aAAa,CAACY,GAAG,CAAAC,KAAA,CAAjBb,aAAa,EAAAc,kBAAA,CAAQR,aAAa,EAAC;IACrC;EACF,CAAC,EAAE,CAACF,KAAK,CAAC,CAAC;EACXN,eAAe,CAAC,YAAM;IACpB,IAAIY,UAAU,CAACC,OAAO,EAAE;MACtB;IACF;IACA,IAAI,CAACT,MAAM,EAAE;MACXQ,UAAU,CAACC,OAAO,GAAG,IAAI;MACzB,IAAIF,iBAAiB,EAAE;QACrBA,iBAAiB,EAAE;MACrB,CAAC,MAAM;QACLT,aAAa,CAACe,OAAO,EAAE;MACzB;IACF;EACF,CAAC,EAAAD,kBAAA,CAAMN,WAAW,EAAE;EACpB,OAAO;IACLQ,QAAQ,EAAE,SAAAA,SAAA,EAAM;MACd,IAAI,CAACZ,KAAK,EAAE;QACV,OAAO;UACLa,OAAO,EAAE;QACX,CAAC;MACH;IACF;EACF,CAAC;AACH,CAAC;AACDlB,gBAAgB,CAACmB,MAAM,GAAG,UAAAC,KAAA,EAGpB;EAAA,IAAAC,WAAA,GAAAD,KAAA,CAFJf,KAAK;IAALA,KAAK,GAAAgB,WAAA,cAAG,IAAI,GAAAA,WAAA;IACZlB,MAAM,GAAAiB,KAAA,CAANjB,MAAM;EAEN,OAAO;IACLmB,OAAO,EAAE,CAACnB,MAAM,IAAIE;EACtB,CAAC;AACH,CAAC;AACD,eAAeL,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}