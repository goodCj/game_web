{"ast":null,"code":"import _defineProperty from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport classNames from 'classnames';\nimport React, { useMemo } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { getTreeDeep } from '../../utils/tree';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nvar classPrefix = \"adm-tree-select\";\nvar defaultProps = {\n  options: [],\n  fieldNames: {},\n  defaultValue: []\n};\nexport var TreeSelect = function TreeSelect(p) {\n  var props = mergeProps(defaultProps, p);\n  var labelName = props.fieldNames.label || 'label';\n  var valueName = props.fieldNames.value || 'value';\n  var childrenName = props.fieldNames.children || 'children';\n  var _usePropsValue = usePropsValue({\n      value: props.value,\n      defaultValue: props.defaultValue\n    }),\n    _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n    value = _usePropsValue2[0],\n    setValue = _usePropsValue2[1];\n  var _useMemo = useMemo(function () {\n      var deep = getTreeDeep(props.options, childrenName);\n      var optionsMap = new Map();\n      var optionsParentMap = new Map();\n      function traverse(current, children) {\n        children.forEach(function (item) {\n          optionsParentMap.set(item[valueName], current);\n          optionsMap.set(item[valueName], item);\n          if (item[childrenName]) {\n            traverse(item, item[childrenName]);\n          }\n        });\n      }\n      traverse(undefined, props.options);\n      return [deep, optionsMap, optionsParentMap];\n    }, [props.options]),\n    _useMemo2 = _slicedToArray(_useMemo, 3),\n    deep = _useMemo2[0],\n    optionsMap = _useMemo2[1],\n    optionsParentMap = _useMemo2[2];\n  var onItemSelect = function onItemSelect(node) {\n    var _a;\n    // 找到父级节点\n    var parentNodes = [];\n    var current = node;\n    while (current) {\n      parentNodes.push(current);\n      var next = optionsParentMap.get(current[valueName]);\n      current = next;\n    }\n    var values = parentNodes.reverse().map(function (i) {\n      return i[valueName];\n    });\n    setValue(values);\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, values, {\n      options: parentNodes\n    });\n  };\n  var renderItems = function renderItems() {\n    var columnOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var index = arguments.length > 1 ? arguments[1] : undefined;\n    return columnOptions.map(function (item) {\n      var isActive = item[valueName] === value[index];\n      return React.createElement(\"div\", {\n        key: item[valueName],\n        className: classNames(\"\".concat(classPrefix, \"-item\"), _defineProperty({}, \"\".concat(classPrefix, \"-item-active\"), isActive)),\n        onClick: function onClick() {\n          if (!isActive) {\n            onItemSelect(item);\n          }\n        }\n      }, item[labelName]);\n    });\n  };\n  var renderColumns = function renderColumns() {\n    var _a;\n    var columns = [];\n    for (var i = 0; i < deep; i++) {\n      var width = \"\".concat(100 / deep, \"%\");\n      // 两列的第一列宽度为 33.33，两列的第二列为 66.67%\n      if (deep === 2 && i === 0) {\n        width = \"33.33%\";\n      }\n      if (deep === 2 && i === 1) {\n        width = \"66.67%\";\n      }\n      var column = React.createElement(\"div\", {\n        key: i,\n        className: classNames(\"\".concat(classPrefix, \"-column\")),\n        style: {\n          width: width\n        }\n      }, renderItems(i === 0 ? props.options : (_a = optionsMap.get(value[i - 1])) === null || _a === void 0 ? void 0 : _a[childrenName], i));\n      columns.push(column);\n    }\n    return columns;\n  };\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, renderColumns()));\n};","map":{"version":3,"names":["classNames","React","useMemo","withNativeProps","getTreeDeep","mergeProps","usePropsValue","classPrefix","defaultProps","options","fieldNames","defaultValue","TreeSelect","p","props","labelName","label","valueName","value","childrenName","children","_usePropsValue","_usePropsValue2","_slicedToArray","setValue","_useMemo","deep","optionsMap","Map","optionsParentMap","traverse","current","forEach","item","set","undefined","_useMemo2","onItemSelect","node","_a","parentNodes","push","next","get","values","reverse","map","i","onChange","call","renderItems","columnOptions","arguments","length","index","isActive","createElement","key","className","concat","_defineProperty","onClick","renderColumns","columns","width","column","style"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/tree-select/tree-select.js"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useMemo } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { getTreeDeep } from '../../utils/tree';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nconst classPrefix = `adm-tree-select`;\nconst defaultProps = {\n  options: [],\n  fieldNames: {},\n  defaultValue: []\n};\nexport const TreeSelect = p => {\n  const props = mergeProps(defaultProps, p);\n  const labelName = props.fieldNames.label || 'label';\n  const valueName = props.fieldNames.value || 'value';\n  const childrenName = props.fieldNames.children || 'children';\n  const [value, setValue] = usePropsValue({\n    value: props.value,\n    defaultValue: props.defaultValue\n  });\n  const [deep, optionsMap, optionsParentMap] = useMemo(() => {\n    const deep = getTreeDeep(props.options, childrenName);\n    const optionsMap = new Map();\n    const optionsParentMap = new Map();\n    function traverse(current, children) {\n      children.forEach(item => {\n        optionsParentMap.set(item[valueName], current);\n        optionsMap.set(item[valueName], item);\n        if (item[childrenName]) {\n          traverse(item, item[childrenName]);\n        }\n      });\n    }\n    traverse(undefined, props.options);\n    return [deep, optionsMap, optionsParentMap];\n  }, [props.options]);\n  const onItemSelect = node => {\n    var _a;\n    // 找到父级节点\n    const parentNodes = [];\n    let current = node;\n    while (current) {\n      parentNodes.push(current);\n      const next = optionsParentMap.get(current[valueName]);\n      current = next;\n    }\n    const values = parentNodes.reverse().map(i => i[valueName]);\n    setValue(values);\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, values, {\n      options: parentNodes\n    });\n  };\n  const renderItems = (columnOptions = [], index) => {\n    return columnOptions.map(item => {\n      const isActive = item[valueName] === value[index];\n      return React.createElement(\"div\", {\n        key: item[valueName],\n        className: classNames(`${classPrefix}-item`, {\n          [`${classPrefix}-item-active`]: isActive\n        }),\n        onClick: () => {\n          if (!isActive) {\n            onItemSelect(item);\n          }\n        }\n      }, item[labelName]);\n    });\n  };\n  const renderColumns = () => {\n    var _a;\n    const columns = [];\n    for (let i = 0; i < deep; i++) {\n      let width = `${100 / deep}%`;\n      // 两列的第一列宽度为 33.33，两列的第二列为 66.67%\n      if (deep === 2 && i === 0) {\n        width = `33.33%`;\n      }\n      if (deep === 2 && i === 1) {\n        width = `66.67%`;\n      }\n      const column = React.createElement(\"div\", {\n        key: i,\n        className: classNames(`${classPrefix}-column`),\n        style: {\n          width\n        }\n      }, renderItems(i === 0 ? props.options : (_a = optionsMap.get(value[i - 1])) === null || _a === void 0 ? void 0 : _a[childrenName], i));\n      columns.push(column);\n    }\n    return columns;\n  };\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, renderColumns()));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}