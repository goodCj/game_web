{"ast":null,"code":"import _toConsumableArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _toArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/toArray.js\";\nimport { __rest } from \"tslib\";\nimport { useMemo } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport useRequest from '../useRequest';\nvar usePagination = function usePagination(service) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _a;\n  var _options$defaultPageS = options.defaultPageSize,\n    defaultPageSize = _options$defaultPageS === void 0 ? 10 : _options$defaultPageS,\n    _options$defaultCurre = options.defaultCurrent,\n    defaultCurrent = _options$defaultCurre === void 0 ? 1 : _options$defaultCurre,\n    rest = __rest(options, [\"defaultPageSize\", \"defaultCurrent\"]);\n  var result = useRequest(service, Object.assign({\n    defaultParams: [{\n      current: defaultCurrent,\n      pageSize: defaultPageSize\n    }],\n    refreshDepsAction: function refreshDepsAction() {\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      changeCurrent(1);\n    }\n  }, rest));\n  var _ref = result.params[0] || {},\n    _ref$current = _ref.current,\n    current = _ref$current === void 0 ? 1 : _ref$current,\n    _ref$pageSize = _ref.pageSize,\n    pageSize = _ref$pageSize === void 0 ? defaultPageSize : _ref$pageSize;\n  var total = ((_a = result.data) === null || _a === void 0 ? void 0 : _a.total) || 0;\n  var totalPage = useMemo(function () {\n    return Math.ceil(total / pageSize);\n  }, [pageSize, total]);\n  var onChange = function onChange(c, p) {\n    var toCurrent = c <= 0 ? 1 : c;\n    var toPageSize = p <= 0 ? 1 : p;\n    var tempTotalPage = Math.ceil(total / toPageSize);\n    if (toCurrent > tempTotalPage) {\n      toCurrent = Math.max(1, tempTotalPage);\n    }\n    var _ref2 = result.params || [],\n      _ref3 = _toArray(_ref2),\n      _ref3$ = _ref3[0],\n      oldPaginationParams = _ref3$ === void 0 ? {} : _ref3$,\n      restParams = _ref3.slice(1);\n    result.run.apply(result, [Object.assign(Object.assign({}, oldPaginationParams), {\n      current: toCurrent,\n      pageSize: toPageSize\n    })].concat(_toConsumableArray(restParams)));\n  };\n  var changeCurrent = function changeCurrent(c) {\n    onChange(c, pageSize);\n  };\n  var changePageSize = function changePageSize(p) {\n    onChange(current, p);\n  };\n  return Object.assign(Object.assign({}, result), {\n    pagination: {\n      current: current,\n      pageSize: pageSize,\n      total: total,\n      totalPage: totalPage,\n      onChange: useMemoizedFn(onChange),\n      changeCurrent: useMemoizedFn(changeCurrent),\n      changePageSize: useMemoizedFn(changePageSize)\n    }\n  });\n};\nexport default usePagination;","map":{"version":3,"names":["__rest","useMemo","useMemoizedFn","useRequest","usePagination","service","options","arguments","length","undefined","_a","_options$defaultPageS","defaultPageSize","_options$defaultCurre","defaultCurrent","rest","result","Object","assign","defaultParams","current","pageSize","refreshDepsAction","changeCurrent","_ref","params","_ref$current","_ref$pageSize","total","data","totalPage","Math","ceil","onChange","c","p","toCurrent","toPageSize","tempTotalPage","max","_ref2","_ref3","_toArray","_ref3$","oldPaginationParams","restParams","slice","run","apply","concat","_toConsumableArray","changePageSize","pagination"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/ahooks/es/usePagination/index.js"],"sourcesContent":["import { __rest } from \"tslib\";\nimport { useMemo } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport useRequest from '../useRequest';\nconst usePagination = (service, options = {}) => {\n  var _a;\n  const {\n      defaultPageSize = 10,\n      defaultCurrent = 1\n    } = options,\n    rest = __rest(options, [\"defaultPageSize\", \"defaultCurrent\"]);\n  const result = useRequest(service, Object.assign({\n    defaultParams: [{\n      current: defaultCurrent,\n      pageSize: defaultPageSize\n    }],\n    refreshDepsAction: () => {\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      changeCurrent(1);\n    }\n  }, rest));\n  const {\n    current = 1,\n    pageSize = defaultPageSize\n  } = result.params[0] || {};\n  const total = ((_a = result.data) === null || _a === void 0 ? void 0 : _a.total) || 0;\n  const totalPage = useMemo(() => Math.ceil(total / pageSize), [pageSize, total]);\n  const onChange = (c, p) => {\n    let toCurrent = c <= 0 ? 1 : c;\n    const toPageSize = p <= 0 ? 1 : p;\n    const tempTotalPage = Math.ceil(total / toPageSize);\n    if (toCurrent > tempTotalPage) {\n      toCurrent = Math.max(1, tempTotalPage);\n    }\n    const [oldPaginationParams = {}, ...restParams] = result.params || [];\n    result.run(Object.assign(Object.assign({}, oldPaginationParams), {\n      current: toCurrent,\n      pageSize: toPageSize\n    }), ...restParams);\n  };\n  const changeCurrent = c => {\n    onChange(c, pageSize);\n  };\n  const changePageSize = p => {\n    onChange(current, p);\n  };\n  return Object.assign(Object.assign({}, result), {\n    pagination: {\n      current,\n      pageSize,\n      total,\n      totalPage,\n      onChange: useMemoizedFn(onChange),\n      changeCurrent: useMemoizedFn(changeCurrent),\n      changePageSize: useMemoizedFn(changePageSize)\n    }\n  });\n};\nexport default usePagination;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}