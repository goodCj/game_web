{"ast":null,"code":"import _defineProperty from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { forwardRef, useRef, useState, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useThrottleFn } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Sidebar } from './sidebar';\nimport { convertPx } from '../../utils/convert-px';\nimport { Panel } from './panel';\nimport { devWarning } from '../../utils/dev-log';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nvar classPrefix = \"adm-index-bar\";\nvar defaultProps = {\n  sticky: true\n};\nexport var IndexBar = forwardRef(function (p, ref) {\n  var props = mergeProps(defaultProps, p);\n  var titleHeight = convertPx(35);\n  var bodyRef = useRef(null);\n  var indexItems = [];\n  var panels = [];\n  traverseReactNode(props.children, function (child) {\n    var _a;\n    if (!React.isValidElement(child)) return;\n    if (child.type !== Panel) {\n      devWarning('IndexBar', 'The children of `IndexBar` must be `IndexBar.Panel` components.');\n      return;\n    }\n    indexItems.push({\n      index: child.props.index,\n      brief: (_a = child.props.brief) !== null && _a !== void 0 ? _a : child.props.index.charAt(0)\n    });\n    panels.push(withNativeProps(child.props, React.createElement(\"div\", {\n      key: child.props.index,\n      \"data-index\": child.props.index,\n      className: \"\".concat(classPrefix, \"-anchor\")\n    }, React.createElement(\"div\", {\n      className: \"\".concat(classPrefix, \"-anchor-title\")\n    }, child.props.title || child.props.index), child.props.children)));\n  });\n  var _useState = useState(function () {\n      var firstItem = indexItems[0];\n      return firstItem ? firstItem.index : null;\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    activeIndex = _useState2[0],\n    setActiveIndex = _useState2[1];\n  useImperativeHandle(ref, function () {\n    return {\n      scrollTo: scrollTo\n    };\n  });\n  function scrollTo(index) {\n    var _a;\n    var body = bodyRef.current;\n    if (!body) return;\n    var children = body.children;\n    for (var i = 0; i < children.length; i++) {\n      var panel = children.item(i);\n      if (!panel) continue;\n      var panelIndex = panel.dataset['index'];\n      if (panelIndex === index) {\n        body.scrollTop = panel.offsetTop;\n        setActiveIndex(index);\n        activeIndex !== index && ((_a = props.onIndexChange) === null || _a === void 0 ? void 0 : _a.call(props, index));\n        return;\n      }\n    }\n  }\n  var _useThrottleFn = useThrottleFn(function () {\n      var _a;\n      var body = bodyRef.current;\n      if (!body) return;\n      var scrollTop = body.scrollTop;\n      var elements = body.getElementsByClassName(\"\".concat(classPrefix, \"-anchor\"));\n      for (var i = 0; i < elements.length; i++) {\n        var panel = elements.item(i);\n        if (!panel) continue;\n        var panelIndex = panel.dataset['index'];\n        if (!panelIndex) continue;\n        if (panel.offsetTop + panel.clientHeight - titleHeight > scrollTop) {\n          setActiveIndex(panelIndex);\n          activeIndex !== panelIndex && ((_a = props.onIndexChange) === null || _a === void 0 ? void 0 : _a.call(props, panelIndex));\n          return;\n        }\n      }\n    }, {\n      wait: 50,\n      trailing: true,\n      leading: true\n    }),\n    checkActiveIndex = _useThrottleFn.run;\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(\"\".concat(classPrefix), _defineProperty({}, \"\".concat(classPrefix, \"-sticky\"), props.sticky))\n  }, React.createElement(Sidebar, {\n    indexItems: indexItems,\n    activeIndex: activeIndex,\n    onActive: function onActive(index) {\n      scrollTo(index);\n    }\n  }), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-body\"),\n    ref: bodyRef,\n    onScroll: checkActiveIndex\n  }, panels)));\n});","map":{"version":3,"names":["React","forwardRef","useRef","useState","useImperativeHandle","classNames","withNativeProps","useThrottleFn","mergeProps","Sidebar","convertPx","Panel","devWarning","traverseReactNode","classPrefix","defaultProps","sticky","IndexBar","p","ref","props","titleHeight","bodyRef","indexItems","panels","children","child","_a","isValidElement","type","push","index","brief","charAt","createElement","key","className","concat","title","_useState","firstItem","_useState2","_slicedToArray","activeIndex","setActiveIndex","scrollTo","body","current","i","length","panel","item","panelIndex","dataset","scrollTop","offsetTop","onIndexChange","call","_useThrottleFn","elements","getElementsByClassName","clientHeight","wait","trailing","leading","checkActiveIndex","run","_defineProperty","onActive","onScroll"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/index-bar/index-bar.js"],"sourcesContent":["import React, { forwardRef, useRef, useState, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useThrottleFn } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Sidebar } from './sidebar';\nimport { convertPx } from '../../utils/convert-px';\nimport { Panel } from './panel';\nimport { devWarning } from '../../utils/dev-log';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nconst classPrefix = `adm-index-bar`;\nconst defaultProps = {\n  sticky: true\n};\nexport const IndexBar = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const titleHeight = convertPx(35);\n  const bodyRef = useRef(null);\n  const indexItems = [];\n  const panels = [];\n  traverseReactNode(props.children, child => {\n    var _a;\n    if (!React.isValidElement(child)) return;\n    if (child.type !== Panel) {\n      devWarning('IndexBar', 'The children of `IndexBar` must be `IndexBar.Panel` components.');\n      return;\n    }\n    indexItems.push({\n      index: child.props.index,\n      brief: (_a = child.props.brief) !== null && _a !== void 0 ? _a : child.props.index.charAt(0)\n    });\n    panels.push(withNativeProps(child.props, React.createElement(\"div\", {\n      key: child.props.index,\n      \"data-index\": child.props.index,\n      className: `${classPrefix}-anchor`\n    }, React.createElement(\"div\", {\n      className: `${classPrefix}-anchor-title`\n    }, child.props.title || child.props.index), child.props.children)));\n  });\n  const [activeIndex, setActiveIndex] = useState(() => {\n    const firstItem = indexItems[0];\n    return firstItem ? firstItem.index : null;\n  });\n  useImperativeHandle(ref, () => ({\n    scrollTo\n  }));\n  function scrollTo(index) {\n    var _a;\n    const body = bodyRef.current;\n    if (!body) return;\n    const children = body.children;\n    for (let i = 0; i < children.length; i++) {\n      const panel = children.item(i);\n      if (!panel) continue;\n      const panelIndex = panel.dataset['index'];\n      if (panelIndex === index) {\n        body.scrollTop = panel.offsetTop;\n        setActiveIndex(index);\n        activeIndex !== index && ((_a = props.onIndexChange) === null || _a === void 0 ? void 0 : _a.call(props, index));\n        return;\n      }\n    }\n  }\n  const {\n    run: checkActiveIndex\n  } = useThrottleFn(() => {\n    var _a;\n    const body = bodyRef.current;\n    if (!body) return;\n    const scrollTop = body.scrollTop;\n    const elements = body.getElementsByClassName(`${classPrefix}-anchor`);\n    for (let i = 0; i < elements.length; i++) {\n      const panel = elements.item(i);\n      if (!panel) continue;\n      const panelIndex = panel.dataset['index'];\n      if (!panelIndex) continue;\n      if (panel.offsetTop + panel.clientHeight - titleHeight > scrollTop) {\n        setActiveIndex(panelIndex);\n        activeIndex !== panelIndex && ((_a = props.onIndexChange) === null || _a === void 0 ? void 0 : _a.call(props, panelIndex));\n        return;\n      }\n    }\n  }, {\n    wait: 50,\n    trailing: true,\n    leading: true\n  });\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(`${classPrefix}`, {\n      [`${classPrefix}-sticky`]: props.sticky\n    })\n  }, React.createElement(Sidebar, {\n    indexItems: indexItems,\n    activeIndex: activeIndex,\n    onActive: index => {\n      scrollTo(index);\n    }\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-body`,\n    ref: bodyRef,\n    onScroll: checkActiveIndex\n  }, panels)));\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}