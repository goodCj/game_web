{"ast":null,"code":"import _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useRef, useEffect, useState } from 'react';\nimport { useSpring, animated, to } from '@react-spring/web';\nimport { useDrag } from '@use-gesture/react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nvar classPrefix = \"adm-floating-bubble\";\nvar defaultProps = {\n  axis: 'y',\n  defaultOffset: {\n    x: 0,\n    y: 0\n  }\n};\nexport var FloatingBubble = function FloatingBubble(p) {\n  var props = mergeProps(defaultProps, p);\n  var boundaryRef = useRef(null);\n  var buttonRef = useRef(null);\n  var _useState = useState(props.offset === undefined ? props.defaultOffset : props.offset),\n    _useState2 = _slicedToArray(_useState, 2),\n    innerValue = _useState2[0],\n    setInnerValue = _useState2[1];\n  useEffect(function () {\n    if (props.offset === undefined) return;\n    api.start({\n      x: props.offset.x,\n      y: props.offset.y\n    });\n  }, [props.offset]);\n  /**\n   * memoize the `to` function\n   * inside a component that renders frequently\n   * to prevent an unintended restart\n   */\n  var _useSpring = useSpring(function () {\n      return {\n        x: innerValue.x,\n        y: innerValue.y,\n        opacity: 1\n      };\n    }),\n    _useSpring2 = _slicedToArray(_useSpring, 2),\n    _useSpring2$ = _useSpring2[0],\n    x = _useSpring2$.x,\n    y = _useSpring2$.y,\n    opacity = _useSpring2$.opacity,\n    api = _useSpring2[1];\n  var bind = useDrag(function (state) {\n    var _a;\n    var nextX = state.offset[0];\n    var nextY = state.offset[1];\n    if (state.last && props.magnetic) {\n      var boundary = boundaryRef.current;\n      var button = buttonRef.current;\n      if (!boundary || !button) return;\n      var boundaryRect = boundary.getBoundingClientRect();\n      var buttonRect = button.getBoundingClientRect();\n      if (props.magnetic === 'x') {\n        var compensation = x.goal - x.get();\n        var leftDistance = buttonRect.left + compensation - boundaryRect.left;\n        var rightDistance = boundaryRect.right - (buttonRect.right + compensation);\n        if (rightDistance <= leftDistance) {\n          nextX += rightDistance;\n        } else {\n          nextX -= leftDistance;\n        }\n      } else if (props.magnetic === 'y') {\n        var _compensation = y.goal - y.get();\n        var topDistance = buttonRect.top + _compensation - boundaryRect.top;\n        var bottomDistance = boundaryRect.bottom - (buttonRect.bottom + _compensation);\n        if (bottomDistance <= topDistance) {\n          nextY += bottomDistance;\n        } else {\n          nextY -= topDistance;\n        }\n      }\n    }\n    var nextOffest = {\n      x: nextX,\n      y: nextY\n    };\n    if (props.offset === undefined) {\n      // Uncontrolled mode\n      api.start(nextOffest);\n    } else {\n      setInnerValue(nextOffest);\n    }\n    (_a = props.onOffsetChange) === null || _a === void 0 ? void 0 : _a.call(props, nextOffest);\n    // active status\n    api.start({\n      opacity: state.active ? 0.8 : 1\n    });\n  }, {\n    axis: props.axis === 'xy' ? undefined : props.axis,\n    pointer: {\n      touch: true\n    },\n    // the component won't trigger drag logic if the user just clicked on the component.\n    filterTaps: true,\n    // set constraints to the user gesture\n    bounds: boundaryRef,\n    from: function from() {\n      return [x.get(), y.get()];\n    }\n  });\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-boundary-outer\")\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-boundary\"),\n    ref: boundaryRef\n  })), React.createElement(animated.div, Object.assign({}, bind(), {\n    style: {\n      opacity: opacity,\n      transform: to([x, y], function (x, y) {\n        return \"translate(\".concat(x, \"px, \").concat(y, \"px)\");\n      })\n    },\n    onClick: props.onClick,\n    className: \"\".concat(classPrefix, \"-button\"),\n    ref: buttonRef\n  }), props.children)));\n};","map":{"version":3,"names":["React","useRef","useEffect","useState","useSpring","animated","to","useDrag","mergeProps","withNativeProps","classPrefix","defaultProps","axis","defaultOffset","x","y","FloatingBubble","p","props","boundaryRef","buttonRef","_useState","offset","undefined","_useState2","_slicedToArray","innerValue","setInnerValue","api","start","_useSpring","opacity","_useSpring2","_useSpring2$","bind","state","_a","nextX","nextY","last","magnetic","boundary","current","button","boundaryRect","getBoundingClientRect","buttonRect","compensation","goal","get","leftDistance","left","rightDistance","right","topDistance","top","bottomDistance","bottom","nextOffest","onOffsetChange","call","active","pointer","touch","filterTaps","bounds","from","createElement","className","concat","ref","div","Object","assign","style","transform","onClick","children"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/floating-bubble/floating-bubble.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport { useSpring, animated, to } from '@react-spring/web';\nimport { useDrag } from '@use-gesture/react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nconst classPrefix = `adm-floating-bubble`;\nconst defaultProps = {\n  axis: 'y',\n  defaultOffset: {\n    x: 0,\n    y: 0\n  }\n};\nexport const FloatingBubble = p => {\n  const props = mergeProps(defaultProps, p);\n  const boundaryRef = useRef(null);\n  const buttonRef = useRef(null);\n  const [innerValue, setInnerValue] = useState(props.offset === undefined ? props.defaultOffset : props.offset);\n  useEffect(() => {\n    if (props.offset === undefined) return;\n    api.start({\n      x: props.offset.x,\n      y: props.offset.y\n    });\n  }, [props.offset]);\n  /**\n   * memoize the `to` function\n   * inside a component that renders frequently\n   * to prevent an unintended restart\n   */\n  const [{\n    x,\n    y,\n    opacity\n  }, api] = useSpring(() => ({\n    x: innerValue.x,\n    y: innerValue.y,\n    opacity: 1\n  }));\n  const bind = useDrag(state => {\n    var _a;\n    let nextX = state.offset[0];\n    let nextY = state.offset[1];\n    if (state.last && props.magnetic) {\n      const boundary = boundaryRef.current;\n      const button = buttonRef.current;\n      if (!boundary || !button) return;\n      const boundaryRect = boundary.getBoundingClientRect();\n      const buttonRect = button.getBoundingClientRect();\n      if (props.magnetic === 'x') {\n        const compensation = x.goal - x.get();\n        const leftDistance = buttonRect.left + compensation - boundaryRect.left;\n        const rightDistance = boundaryRect.right - (buttonRect.right + compensation);\n        if (rightDistance <= leftDistance) {\n          nextX += rightDistance;\n        } else {\n          nextX -= leftDistance;\n        }\n      } else if (props.magnetic === 'y') {\n        const compensation = y.goal - y.get();\n        const topDistance = buttonRect.top + compensation - boundaryRect.top;\n        const bottomDistance = boundaryRect.bottom - (buttonRect.bottom + compensation);\n        if (bottomDistance <= topDistance) {\n          nextY += bottomDistance;\n        } else {\n          nextY -= topDistance;\n        }\n      }\n    }\n    const nextOffest = {\n      x: nextX,\n      y: nextY\n    };\n    if (props.offset === undefined) {\n      // Uncontrolled mode\n      api.start(nextOffest);\n    } else {\n      setInnerValue(nextOffest);\n    }\n    (_a = props.onOffsetChange) === null || _a === void 0 ? void 0 : _a.call(props, nextOffest);\n    // active status\n    api.start({\n      opacity: state.active ? 0.8 : 1\n    });\n  }, {\n    axis: props.axis === 'xy' ? undefined : props.axis,\n    pointer: {\n      touch: true\n    },\n    // the component won't trigger drag logic if the user just clicked on the component.\n    filterTaps: true,\n    // set constraints to the user gesture\n    bounds: boundaryRef,\n    from: () => [x.get(), y.get()]\n  });\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-boundary-outer`\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-boundary`,\n    ref: boundaryRef\n  })), React.createElement(animated.div, Object.assign({}, bind(), {\n    style: {\n      opacity,\n      transform: to([x, y], (x, y) => `translate(${x}px, ${y}px)`)\n    },\n    onClick: props.onClick,\n    className: `${classPrefix}-button`,\n    ref: buttonRef\n  }), props.children)));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}