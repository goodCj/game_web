{"ast":null,"code":"import _toConsumableArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { useRef, useState } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport { isNumber } from '../utils';\nvar dumpIndex = function dumpIndex(step, arr) {\n  var index = step > 0 ? step - 1 // move forward\n  : arr.length + step; // move backward\n  if (index >= arr.length - 1) {\n    index = arr.length - 1;\n  }\n  if (index < 0) {\n    index = 0;\n  }\n  return index;\n};\nvar split = function split(step, targetArr) {\n  var index = dumpIndex(step, targetArr);\n  return {\n    _current: targetArr[index],\n    _before: targetArr.slice(0, index),\n    _after: targetArr.slice(index + 1)\n  };\n};\nexport default function useHistoryTravel(initialValue) {\n  var maxLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var _useState = useState({\n      present: initialValue,\n      past: [],\n      future: []\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    history = _useState2[0],\n    setHistory = _useState2[1];\n  var present = history.present,\n    past = history.past,\n    future = history.future;\n  var initialValueRef = useRef(initialValue);\n  var reset = function reset() {\n    var _initial = arguments.length > 0 ? arguments.length <= 0 ? undefined : arguments[0] : initialValueRef.current;\n    initialValueRef.current = _initial;\n    setHistory({\n      present: _initial,\n      future: [],\n      past: []\n    });\n  };\n  var updateValue = function updateValue(val) {\n    var _past = [].concat(_toConsumableArray(past), [present]);\n    var maxLengthNum = isNumber(maxLength) ? maxLength : Number(maxLength);\n    // maximum number of records exceeded\n    if (maxLengthNum > 0 && _past.length > maxLengthNum) {\n      //delete first\n      _past.splice(0, 1);\n    }\n    setHistory({\n      present: val,\n      future: [],\n      past: _past\n    });\n  };\n  var _forward = function _forward() {\n    var step = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    if (future.length === 0) {\n      return;\n    }\n    var _split = split(step, future),\n      _before = _split._before,\n      _current = _split._current,\n      _after = _split._after;\n    setHistory({\n      past: [].concat(_toConsumableArray(past), [present], _toConsumableArray(_before)),\n      present: _current,\n      future: _after\n    });\n  };\n  var _backward = function _backward() {\n    var step = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n    if (past.length === 0) {\n      return;\n    }\n    var _split2 = split(step, past),\n      _before = _split2._before,\n      _current = _split2._current,\n      _after = _split2._after;\n    setHistory({\n      past: _before,\n      present: _current,\n      future: [].concat(_toConsumableArray(_after), [present], _toConsumableArray(future))\n    });\n  };\n  var go = function go(step) {\n    var stepNum = isNumber(step) ? step : Number(step);\n    if (stepNum === 0) {\n      return;\n    }\n    if (stepNum > 0) {\n      return _forward(stepNum);\n    }\n    _backward(stepNum);\n  };\n  return {\n    value: present,\n    backLength: past.length,\n    forwardLength: future.length,\n    setValue: useMemoizedFn(updateValue),\n    go: useMemoizedFn(go),\n    back: useMemoizedFn(function () {\n      go(-1);\n    }),\n    forward: useMemoizedFn(function () {\n      go(1);\n    }),\n    reset: useMemoizedFn(reset)\n  };\n}","map":{"version":3,"names":["useRef","useState","useMemoizedFn","isNumber","dumpIndex","step","arr","index","length","split","targetArr","_current","_before","slice","_after","useHistoryTravel","initialValue","maxLength","arguments","undefined","_useState","present","past","future","_useState2","_slicedToArray","history","setHistory","initialValueRef","reset","_initial","current","updateValue","val","_past","concat","_toConsumableArray","maxLengthNum","Number","splice","_forward","_split","_backward","_split2","go","stepNum","value","backLength","forwardLength","setValue","back","forward"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/ahooks/es/useHistoryTravel/index.js"],"sourcesContent":["import { useRef, useState } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport { isNumber } from '../utils';\nconst dumpIndex = (step, arr) => {\n  let index = step > 0 ? step - 1 // move forward\n  : arr.length + step; // move backward\n  if (index >= arr.length - 1) {\n    index = arr.length - 1;\n  }\n  if (index < 0) {\n    index = 0;\n  }\n  return index;\n};\nconst split = (step, targetArr) => {\n  const index = dumpIndex(step, targetArr);\n  return {\n    _current: targetArr[index],\n    _before: targetArr.slice(0, index),\n    _after: targetArr.slice(index + 1)\n  };\n};\nexport default function useHistoryTravel(initialValue, maxLength = 0) {\n  const [history, setHistory] = useState({\n    present: initialValue,\n    past: [],\n    future: []\n  });\n  const {\n    present,\n    past,\n    future\n  } = history;\n  const initialValueRef = useRef(initialValue);\n  const reset = (...params) => {\n    const _initial = params.length > 0 ? params[0] : initialValueRef.current;\n    initialValueRef.current = _initial;\n    setHistory({\n      present: _initial,\n      future: [],\n      past: []\n    });\n  };\n  const updateValue = val => {\n    const _past = [...past, present];\n    const maxLengthNum = isNumber(maxLength) ? maxLength : Number(maxLength);\n    // maximum number of records exceeded\n    if (maxLengthNum > 0 && _past.length > maxLengthNum) {\n      //delete first\n      _past.splice(0, 1);\n    }\n    setHistory({\n      present: val,\n      future: [],\n      past: _past\n    });\n  };\n  const _forward = (step = 1) => {\n    if (future.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, future);\n    setHistory({\n      past: [...past, present, ..._before],\n      present: _current,\n      future: _after\n    });\n  };\n  const _backward = (step = -1) => {\n    if (past.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, past);\n    setHistory({\n      past: _before,\n      present: _current,\n      future: [..._after, present, ...future]\n    });\n  };\n  const go = step => {\n    const stepNum = isNumber(step) ? step : Number(step);\n    if (stepNum === 0) {\n      return;\n    }\n    if (stepNum > 0) {\n      return _forward(stepNum);\n    }\n    _backward(stepNum);\n  };\n  return {\n    value: present,\n    backLength: past.length,\n    forwardLength: future.length,\n    setValue: useMemoizedFn(updateValue),\n    go: useMemoizedFn(go),\n    back: useMemoizedFn(() => {\n      go(-1);\n    }),\n    forward: useMemoizedFn(() => {\n      go(1);\n    }),\n    reset: useMemoizedFn(reset)\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}