{"ast":null,"code":"import _defineProperty from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { useClickAway } from 'ahooks';\nimport classNames from 'classnames';\nimport React, { cloneElement, useEffect, useRef, useState, forwardRef, useImperativeHandle } from 'react';\nimport Popup from '../popup';\nimport { ItemChildrenWrap } from './item';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nvar classPrefix = \"adm-dropdown\";\nvar defaultProps = {\n  defaultActiveKey: null,\n  closeOnMaskClick: true,\n  closeOnClickAway: false\n};\nvar Dropdown = forwardRef(function (p, ref) {\n  var props = mergeProps(defaultProps, p);\n  var _usePropsValue = usePropsValue({\n      value: props.activeKey,\n      defaultValue: props.defaultActiveKey,\n      onChange: props.onChange\n    }),\n    _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n    value = _usePropsValue2[0],\n    setValue = _usePropsValue2[1];\n  var navRef = useRef(null);\n  var contentRef = useRef(null);\n  // 点击外部区域，关闭\n  useClickAway(function () {\n    if (!props.closeOnClickAway) return;\n    setValue(null);\n  }, [navRef, contentRef]);\n  // 计算 navs 的 top 值\n  var _useState = useState(),\n    _useState2 = _slicedToArray(_useState, 2),\n    top = _useState2[0],\n    setTop = _useState2[1];\n  var containerRef = useRef(null);\n  useEffect(function () {\n    var container = containerRef.current;\n    if (!container) return;\n    if (value) {\n      var rect = container.getBoundingClientRect();\n      setTop(rect.bottom);\n    }\n  }, [value]);\n  var changeActive = function changeActive(key) {\n    if (value === key) {\n      setValue(null);\n    } else {\n      setValue(key);\n    }\n  };\n  var popupForceRender = false;\n  var items = [];\n  var navs = React.Children.map(props.children, function (child) {\n    if (React.isValidElement(child)) {\n      var childProps = Object.assign(Object.assign({}, child.props), {\n        onClick: function onClick() {\n          changeActive(child.key);\n        },\n        active: child.key === value,\n        arrow: child.props.arrow === undefined ? props.arrow : child.props.arrow\n      });\n      items.push(child);\n      if (child.props.forceRender) popupForceRender = true;\n      return cloneElement(child, childProps);\n    } else {\n      return child;\n    }\n  });\n  useImperativeHandle(ref, function () {\n    return {\n      close: function close() {\n        setValue(null);\n      }\n    };\n  }, [setValue]);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, _defineProperty({}, \"\".concat(classPrefix, \"-open\"), !!value)),\n    ref: containerRef\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-nav\"),\n    ref: navRef\n  }, navs), React.createElement(Popup, {\n    visible: !!value,\n    position: 'top',\n    className: \"\".concat(classPrefix, \"-popup\"),\n    maskClassName: \"\".concat(classPrefix, \"-popup-mask\"),\n    bodyClassName: \"\".concat(classPrefix, \"-popup-body\"),\n    style: {\n      top: top\n    },\n    forceRender: popupForceRender,\n    onMaskClick: props.closeOnMaskClick ? function () {\n      changeActive(null);\n    } : undefined\n  }, React.createElement(\"div\", {\n    ref: contentRef\n  }, items.map(function (item) {\n    var isActive = item.key === value;\n    return React.createElement(ItemChildrenWrap, {\n      key: item.key,\n      active: isActive,\n      forceRender: item.props.forceRender,\n      destroyOnClose: item.props.destroyOnClose\n    }, item.props.children);\n  })))));\n});\nexport default Dropdown;","map":{"version":3,"names":["useClickAway","classNames","React","cloneElement","useEffect","useRef","useState","forwardRef","useImperativeHandle","Popup","ItemChildrenWrap","withNativeProps","mergeProps","usePropsValue","classPrefix","defaultProps","defaultActiveKey","closeOnMaskClick","closeOnClickAway","Dropdown","p","ref","props","_usePropsValue","value","activeKey","defaultValue","onChange","_usePropsValue2","_slicedToArray","setValue","navRef","contentRef","_useState","_useState2","top","setTop","containerRef","container","current","rect","getBoundingClientRect","bottom","changeActive","key","popupForceRender","items","navs","Children","map","children","child","isValidElement","childProps","Object","assign","onClick","active","arrow","undefined","push","forceRender","close","createElement","className","_defineProperty","concat","visible","position","maskClassName","bodyClassName","style","onMaskClick","item","isActive","destroyOnClose"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/dropdown/dropdown.js"],"sourcesContent":["import { useClickAway } from 'ahooks';\nimport classNames from 'classnames';\nimport React, { cloneElement, useEffect, useRef, useState, forwardRef, useImperativeHandle } from 'react';\nimport Popup from '../popup';\nimport { ItemChildrenWrap } from './item';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nconst classPrefix = `adm-dropdown`;\nconst defaultProps = {\n  defaultActiveKey: null,\n  closeOnMaskClick: true,\n  closeOnClickAway: false\n};\nconst Dropdown = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue({\n    value: props.activeKey,\n    defaultValue: props.defaultActiveKey,\n    onChange: props.onChange\n  });\n  const navRef = useRef(null);\n  const contentRef = useRef(null);\n  // 点击外部区域，关闭\n  useClickAway(() => {\n    if (!props.closeOnClickAway) return;\n    setValue(null);\n  }, [navRef, contentRef]);\n  // 计算 navs 的 top 值\n  const [top, setTop] = useState();\n  const containerRef = useRef(null);\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    if (value) {\n      const rect = container.getBoundingClientRect();\n      setTop(rect.bottom);\n    }\n  }, [value]);\n  const changeActive = key => {\n    if (value === key) {\n      setValue(null);\n    } else {\n      setValue(key);\n    }\n  };\n  let popupForceRender = false;\n  const items = [];\n  const navs = React.Children.map(props.children, child => {\n    if (React.isValidElement(child)) {\n      const childProps = Object.assign(Object.assign({}, child.props), {\n        onClick: () => {\n          changeActive(child.key);\n        },\n        active: child.key === value,\n        arrow: child.props.arrow === undefined ? props.arrow : child.props.arrow\n      });\n      items.push(child);\n      if (child.props.forceRender) popupForceRender = true;\n      return cloneElement(child, childProps);\n    } else {\n      return child;\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    close: () => {\n      setValue(null);\n    }\n  }), [setValue]);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-open`]: !!value\n    }),\n    ref: containerRef\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-nav`,\n    ref: navRef\n  }, navs), React.createElement(Popup, {\n    visible: !!value,\n    position: 'top',\n    className: `${classPrefix}-popup`,\n    maskClassName: `${classPrefix}-popup-mask`,\n    bodyClassName: `${classPrefix}-popup-body`,\n    style: {\n      top\n    },\n    forceRender: popupForceRender,\n    onMaskClick: props.closeOnMaskClick ? () => {\n      changeActive(null);\n    } : undefined\n  }, React.createElement(\"div\", {\n    ref: contentRef\n  }, items.map(item => {\n    const isActive = item.key === value;\n    return React.createElement(ItemChildrenWrap, {\n      key: item.key,\n      active: isActive,\n      forceRender: item.props.forceRender,\n      destroyOnClose: item.props.destroyOnClose\n    }, item.props.children);\n  })))));\n});\nexport default Dropdown;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}