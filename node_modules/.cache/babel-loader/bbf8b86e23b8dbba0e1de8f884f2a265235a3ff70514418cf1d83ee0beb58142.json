{"ast":null,"code":"import _defineProperty from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { Star } from './star';\nimport { useDrag } from '@use-gesture/react';\nimport { bound } from '../../utils/bound';\nvar classPrefix = \"adm-rate\";\nvar defaultProps = {\n  count: 5,\n  allowHalf: false,\n  character: React.createElement(Star, null),\n  defaultValue: 0,\n  readOnly: false,\n  allowClear: true\n};\nexport var Rate = function Rate(p) {\n  var props = mergeProps(defaultProps, p);\n  var _usePropsValue = usePropsValue(props),\n    _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n    value = _usePropsValue2[0],\n    setValue = _usePropsValue2[1];\n  var containerRef = useRef(null);\n  var starList = Array(props.count).fill(null);\n  function renderStar(v, half) {\n    var _classNames;\n    return React.createElement(\"div\", {\n      className: classNames(\"\".concat(classPrefix, \"-star\"), (_classNames = {}, _defineProperty(_classNames, \"\".concat(classPrefix, \"-star-active\"), value >= v), _defineProperty(_classNames, \"\".concat(classPrefix, \"-star-half\"), half), _defineProperty(_classNames, \"\".concat(classPrefix, \"-star-readonly\"), props.readOnly), _classNames)),\n      role: 'radio',\n      \"aria-checked\": value >= v,\n      \"aria-label\": '' + v\n    }, props.character);\n  }\n  var bind = useDrag(function (state) {\n    if (props.readOnly) return;\n    var _state$xy = _slicedToArray(state.xy, 1),\n      clientX = _state$xy[0],\n      tap = state.tap;\n    var container = containerRef.current;\n    if (!container) return;\n    var rect = container.getBoundingClientRect();\n    var rawValue = (clientX - rect.left) / rect.width * props.count;\n    var ceiledValue = props.allowHalf ? Math.ceil(rawValue * 2) / 2 : Math.ceil(rawValue);\n    var boundValue = bound(ceiledValue, 0, props.count);\n    if (tap) {\n      if (props.allowClear && boundValue === value) {\n        setValue(0);\n        return;\n      }\n    }\n    setValue(boundValue);\n  }, {\n    axis: 'x',\n    pointer: {\n      touch: true\n    },\n    filterTaps: true\n  });\n  return withNativeProps(props, React.createElement(\"div\", Object.assign({\n    className: classNames(classPrefix, _defineProperty({}, \"\".concat(classPrefix, \"-half\"), props.allowHalf)),\n    role: 'radiogroup',\n    \"aria-readonly\": props.readOnly,\n    ref: containerRef\n  }, bind()), starList.map(function (_, i) {\n    return React.createElement(\"div\", {\n      key: i,\n      className: classNames(\"\".concat(classPrefix, \"-box\"))\n    }, props.allowHalf && renderStar(i + 0.5, true), renderStar(i + 1, false));\n  })));\n};","map":{"version":3,"names":["React","useRef","classNames","withNativeProps","mergeProps","usePropsValue","Star","useDrag","bound","classPrefix","defaultProps","count","allowHalf","character","createElement","defaultValue","readOnly","allowClear","Rate","p","props","_usePropsValue","_usePropsValue2","_slicedToArray","value","setValue","containerRef","starList","Array","fill","renderStar","v","half","_classNames","className","concat","_defineProperty","role","bind","state","_state$xy","xy","clientX","tap","container","current","rect","getBoundingClientRect","rawValue","left","width","ceiledValue","Math","ceil","boundValue","axis","pointer","touch","filterTaps","Object","assign","ref","map","_","i","key"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/rate/rate.js"],"sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { Star } from './star';\nimport { useDrag } from '@use-gesture/react';\nimport { bound } from '../../utils/bound';\nconst classPrefix = `adm-rate`;\nconst defaultProps = {\n  count: 5,\n  allowHalf: false,\n  character: React.createElement(Star, null),\n  defaultValue: 0,\n  readOnly: false,\n  allowClear: true\n};\nexport const Rate = p => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue(props);\n  const containerRef = useRef(null);\n  const starList = Array(props.count).fill(null);\n  function renderStar(v, half) {\n    return React.createElement(\"div\", {\n      className: classNames(`${classPrefix}-star`, {\n        [`${classPrefix}-star-active`]: value >= v,\n        [`${classPrefix}-star-half`]: half,\n        [`${classPrefix}-star-readonly`]: props.readOnly\n      }),\n      role: 'radio',\n      \"aria-checked\": value >= v,\n      \"aria-label\": '' + v\n    }, props.character);\n  }\n  const bind = useDrag(state => {\n    if (props.readOnly) return;\n    const {\n      xy: [clientX],\n      tap\n    } = state;\n    const container = containerRef.current;\n    if (!container) return;\n    const rect = container.getBoundingClientRect();\n    const rawValue = (clientX - rect.left) / rect.width * props.count;\n    const ceiledValue = props.allowHalf ? Math.ceil(rawValue * 2) / 2 : Math.ceil(rawValue);\n    const boundValue = bound(ceiledValue, 0, props.count);\n    if (tap) {\n      if (props.allowClear && boundValue === value) {\n        setValue(0);\n        return;\n      }\n    }\n    setValue(boundValue);\n  }, {\n    axis: 'x',\n    pointer: {\n      touch: true\n    },\n    filterTaps: true\n  });\n  return withNativeProps(props, React.createElement(\"div\", Object.assign({\n    className: classNames(classPrefix, {\n      [`${classPrefix}-half`]: props.allowHalf\n    }),\n    role: 'radiogroup',\n    \"aria-readonly\": props.readOnly,\n    ref: containerRef\n  }, bind()), starList.map((_, i) => React.createElement(\"div\", {\n    key: i,\n    className: classNames(`${classPrefix}-box`)\n  }, props.allowHalf && renderStar(i + 0.5, true), renderStar(i + 1, false)))));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}