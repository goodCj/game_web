{"ast":null,"code":"import _defineProperty from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/liusu/Desktop/h5_free/game/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useState, useRef, memo } from 'react';\nimport classNames from 'classnames';\nimport { CloseOutline, SoundOutline } from 'antd-mobile-icons';\nimport { useTimeout } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useResizeEffect } from '../../utils/use-resize-effect';\nimport { useMutationEffect } from '../../utils/use-mutation-effect';\nvar classPrefix = \"adm-notice-bar\";\nvar defaultProps = {\n  color: 'default',\n  delay: 2000,\n  speed: 50,\n  wrap: false,\n  icon: React.createElement(SoundOutline, null)\n};\nexport var NoticeBar = memo(function (p) {\n  var props = mergeProps(defaultProps, p);\n  var containerRef = useRef(null);\n  var textRef = useRef(null);\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    visible = _useState2[0],\n    setVisible = _useState2[1];\n  var speed = props.speed;\n  var delayLockRef = useRef(true);\n  var animatingRef = useRef(false);\n  function start() {\n    if (delayLockRef.current || props.wrap) return;\n    var container = containerRef.current;\n    var text = textRef.current;\n    if (!container || !text) return;\n    if (container.offsetWidth >= text.offsetWidth) {\n      animatingRef.current = false;\n      text.style.removeProperty('transition-duration');\n      text.style.removeProperty('transform');\n      return;\n    }\n    if (animatingRef.current) return;\n    var initial = !text.style.transform;\n    text.style.transitionDuration = '0s';\n    if (initial) {\n      text.style.transform = 'translateX(0)';\n    } else {\n      text.style.transform = \"translateX(\".concat(container.offsetWidth, \"px)\");\n    }\n    var distance = initial ? text.offsetWidth : container.offsetWidth + text.offsetWidth;\n    animatingRef.current = true;\n    text.style.transitionDuration = \"\".concat(Math.round(distance / speed), \"s\");\n    text.style.transform = \"translateX(-\".concat(text.offsetWidth, \"px)\");\n  }\n  useTimeout(function () {\n    delayLockRef.current = false;\n    start();\n  }, props.delay);\n  useResizeEffect(function () {\n    start();\n  }, containerRef);\n  useMutationEffect(function () {\n    start();\n  }, textRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  if (!visible) return null;\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, \"\".concat(classPrefix, \"-\").concat(props.color), _defineProperty({}, \"\".concat(classPrefix, \"-wrap\"), props.wrap))\n  }, props.icon && React.createElement(\"span\", {\n    className: \"\".concat(classPrefix, \"-left\")\n  }, props.icon), React.createElement(\"span\", {\n    ref: containerRef,\n    className: \"\".concat(classPrefix, \"-content\")\n  }, React.createElement(\"span\", {\n    onTransitionEnd: function onTransitionEnd() {\n      animatingRef.current = false;\n      start();\n    },\n    ref: textRef,\n    className: \"\".concat(classPrefix, \"-content-inner\")\n  }, props.content)), (props.closeable || props.extra) && React.createElement(\"span\", {\n    className: \"\".concat(classPrefix, \"-right\")\n  }, props.extra, props.closeable && React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-close\"),\n    onClick: function onClick() {\n      var _a;\n      setVisible(false);\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseOutline, {\n    className: \"\".concat(classPrefix, \"-close-icon\")\n  })))));\n});","map":{"version":3,"names":["React","useState","useRef","memo","classNames","CloseOutline","SoundOutline","useTimeout","mergeProps","withNativeProps","useResizeEffect","useMutationEffect","classPrefix","defaultProps","color","delay","speed","wrap","icon","createElement","NoticeBar","p","props","containerRef","textRef","_useState","_useState2","_slicedToArray","visible","setVisible","delayLockRef","animatingRef","start","current","container","text","offsetWidth","style","removeProperty","initial","transform","transitionDuration","concat","distance","Math","round","subtree","childList","characterData","className","_defineProperty","ref","onTransitionEnd","content","closeable","extra","onClick","_a","onClose","call"],"sources":["/Users/liusu/Desktop/h5_free/game/node_modules/antd-mobile/es/components/notice-bar/notice-bar.js"],"sourcesContent":["import React, { useState, useRef, memo } from 'react';\nimport classNames from 'classnames';\nimport { CloseOutline, SoundOutline } from 'antd-mobile-icons';\nimport { useTimeout } from 'ahooks';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useResizeEffect } from '../../utils/use-resize-effect';\nimport { useMutationEffect } from '../../utils/use-mutation-effect';\nconst classPrefix = `adm-notice-bar`;\nconst defaultProps = {\n  color: 'default',\n  delay: 2000,\n  speed: 50,\n  wrap: false,\n  icon: React.createElement(SoundOutline, null)\n};\nexport const NoticeBar = memo(p => {\n  const props = mergeProps(defaultProps, p);\n  const containerRef = useRef(null);\n  const textRef = useRef(null);\n  const [visible, setVisible] = useState(true);\n  const speed = props.speed;\n  const delayLockRef = useRef(true);\n  const animatingRef = useRef(false);\n  function start() {\n    if (delayLockRef.current || props.wrap) return;\n    const container = containerRef.current;\n    const text = textRef.current;\n    if (!container || !text) return;\n    if (container.offsetWidth >= text.offsetWidth) {\n      animatingRef.current = false;\n      text.style.removeProperty('transition-duration');\n      text.style.removeProperty('transform');\n      return;\n    }\n    if (animatingRef.current) return;\n    const initial = !text.style.transform;\n    text.style.transitionDuration = '0s';\n    if (initial) {\n      text.style.transform = 'translateX(0)';\n    } else {\n      text.style.transform = `translateX(${container.offsetWidth}px)`;\n    }\n    const distance = initial ? text.offsetWidth : container.offsetWidth + text.offsetWidth;\n    animatingRef.current = true;\n    text.style.transitionDuration = `${Math.round(distance / speed)}s`;\n    text.style.transform = `translateX(-${text.offsetWidth}px)`;\n  }\n  useTimeout(() => {\n    delayLockRef.current = false;\n    start();\n  }, props.delay);\n  useResizeEffect(() => {\n    start();\n  }, containerRef);\n  useMutationEffect(() => {\n    start();\n  }, textRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  if (!visible) return null;\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, `${classPrefix}-${props.color}`, {\n      [`${classPrefix}-wrap`]: props.wrap\n    })\n  }, props.icon && React.createElement(\"span\", {\n    className: `${classPrefix}-left`\n  }, props.icon), React.createElement(\"span\", {\n    ref: containerRef,\n    className: `${classPrefix}-content`\n  }, React.createElement(\"span\", {\n    onTransitionEnd: () => {\n      animatingRef.current = false;\n      start();\n    },\n    ref: textRef,\n    className: `${classPrefix}-content-inner`\n  }, props.content)), (props.closeable || props.extra) && React.createElement(\"span\", {\n    className: `${classPrefix}-right`\n  }, props.extra, props.closeable && React.createElement(\"div\", {\n    className: `${classPrefix}-close`,\n    onClick: () => {\n      var _a;\n      setVisible(false);\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseOutline, {\n    className: `${classPrefix}-close-icon`\n  })))));\n});"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,IAAI,QAAQ,OAAO;AACrD,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,YAAY,EAAEC,YAAY,QAAQ,mBAAmB;AAC9D,SAASC,UAAU,QAAQ,QAAQ;AACnC,SAASC,UAAU,QAAQ,gCAAgC;AAC3D,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,eAAe,QAAQ,+BAA+B;AAC/D,SAASC,iBAAiB,QAAQ,iCAAiC;AACnE,IAAMC,WAAW,mBAAmB;AACpC,IAAMC,YAAY,GAAG;EACnBC,KAAK,EAAE,SAAS;EAChBC,KAAK,EAAE,IAAI;EACXC,KAAK,EAAE,EAAE;EACTC,IAAI,EAAE,KAAK;EACXC,IAAI,EAAElB,KAAK,CAACmB,aAAa,CAACb,YAAY,EAAE,IAAI;AAC9C,CAAC;AACD,OAAO,IAAMc,SAAS,GAAGjB,IAAI,CAAC,UAAAkB,CAAC,EAAI;EACjC,IAAMC,KAAK,GAAGd,UAAU,CAACK,YAAY,EAAEQ,CAAC,CAAC;EACzC,IAAME,YAAY,GAAGrB,MAAM,CAAC,IAAI,CAAC;EACjC,IAAMsB,OAAO,GAAGtB,MAAM,CAAC,IAAI,CAAC;EAC5B,IAAAuB,SAAA,GAA8BxB,QAAQ,CAAC,IAAI,CAAC;IAAAyB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAArCG,OAAO,GAAAF,UAAA;IAAEG,UAAU,GAAAH,UAAA;EAC1B,IAAMV,KAAK,GAAGM,KAAK,CAACN,KAAK;EACzB,IAAMc,YAAY,GAAG5B,MAAM,CAAC,IAAI,CAAC;EACjC,IAAM6B,YAAY,GAAG7B,MAAM,CAAC,KAAK,CAAC;EAClC,SAAS8B,KAAKA,CAAA,EAAG;IACf,IAAIF,YAAY,CAACG,OAAO,IAAIX,KAAK,CAACL,IAAI,EAAE;IACxC,IAAMiB,SAAS,GAAGX,YAAY,CAACU,OAAO;IACtC,IAAME,IAAI,GAAGX,OAAO,CAACS,OAAO;IAC5B,IAAI,CAACC,SAAS,IAAI,CAACC,IAAI,EAAE;IACzB,IAAID,SAAS,CAACE,WAAW,IAAID,IAAI,CAACC,WAAW,EAAE;MAC7CL,YAAY,CAACE,OAAO,GAAG,KAAK;MAC5BE,IAAI,CAACE,KAAK,CAACC,cAAc,CAAC,qBAAqB,CAAC;MAChDH,IAAI,CAACE,KAAK,CAACC,cAAc,CAAC,WAAW,CAAC;MACtC;IACF;IACA,IAAIP,YAAY,CAACE,OAAO,EAAE;IAC1B,IAAMM,OAAO,GAAG,CAACJ,IAAI,CAACE,KAAK,CAACG,SAAS;IACrCL,IAAI,CAACE,KAAK,CAACI,kBAAkB,GAAG,IAAI;IACpC,IAAIF,OAAO,EAAE;MACXJ,IAAI,CAACE,KAAK,CAACG,SAAS,GAAG,eAAe;IACxC,CAAC,MAAM;MACLL,IAAI,CAACE,KAAK,CAACG,SAAS,iBAAAE,MAAA,CAAiBR,SAAS,CAACE,WAAW,QAAK;IACjE;IACA,IAAMO,QAAQ,GAAGJ,OAAO,GAAGJ,IAAI,CAACC,WAAW,GAAGF,SAAS,CAACE,WAAW,GAAGD,IAAI,CAACC,WAAW;IACtFL,YAAY,CAACE,OAAO,GAAG,IAAI;IAC3BE,IAAI,CAACE,KAAK,CAACI,kBAAkB,MAAAC,MAAA,CAAME,IAAI,CAACC,KAAK,CAACF,QAAQ,GAAG3B,KAAK,CAAC,MAAG;IAClEmB,IAAI,CAACE,KAAK,CAACG,SAAS,kBAAAE,MAAA,CAAkBP,IAAI,CAACC,WAAW,QAAK;EAC7D;EACA7B,UAAU,CAAC,YAAM;IACfuB,YAAY,CAACG,OAAO,GAAG,KAAK;IAC5BD,KAAK,EAAE;EACT,CAAC,EAAEV,KAAK,CAACP,KAAK,CAAC;EACfL,eAAe,CAAC,YAAM;IACpBsB,KAAK,EAAE;EACT,CAAC,EAAET,YAAY,CAAC;EAChBZ,iBAAiB,CAAC,YAAM;IACtBqB,KAAK,EAAE;EACT,CAAC,EAAER,OAAO,EAAE;IACVsB,OAAO,EAAE,IAAI;IACbC,SAAS,EAAE,IAAI;IACfC,aAAa,EAAE;EACjB,CAAC,CAAC;EACF,IAAI,CAACpB,OAAO,EAAE,OAAO,IAAI;EACzB,OAAOnB,eAAe,CAACa,KAAK,EAAEtB,KAAK,CAACmB,aAAa,CAAC,KAAK,EAAE;IACvD8B,SAAS,EAAE7C,UAAU,CAACQ,WAAW,KAAA8B,MAAA,CAAK9B,WAAW,OAAA8B,MAAA,CAAIpB,KAAK,CAACR,KAAK,GAAAoC,eAAA,QAAAR,MAAA,CAC1D9B,WAAW,YAAUU,KAAK,CAACL,IAAI;EAEvC,CAAC,EAAEK,KAAK,CAACJ,IAAI,IAAIlB,KAAK,CAACmB,aAAa,CAAC,MAAM,EAAE;IAC3C8B,SAAS,KAAAP,MAAA,CAAK9B,WAAW;EAC3B,CAAC,EAAEU,KAAK,CAACJ,IAAI,CAAC,EAAElB,KAAK,CAACmB,aAAa,CAAC,MAAM,EAAE;IAC1CgC,GAAG,EAAE5B,YAAY;IACjB0B,SAAS,KAAAP,MAAA,CAAK9B,WAAW;EAC3B,CAAC,EAAEZ,KAAK,CAACmB,aAAa,CAAC,MAAM,EAAE;IAC7BiC,eAAe,EAAE,SAAAA,gBAAA,EAAM;MACrBrB,YAAY,CAACE,OAAO,GAAG,KAAK;MAC5BD,KAAK,EAAE;IACT,CAAC;IACDmB,GAAG,EAAE3B,OAAO;IACZyB,SAAS,KAAAP,MAAA,CAAK9B,WAAW;EAC3B,CAAC,EAAEU,KAAK,CAAC+B,OAAO,CAAC,CAAC,EAAE,CAAC/B,KAAK,CAACgC,SAAS,IAAIhC,KAAK,CAACiC,KAAK,KAAKvD,KAAK,CAACmB,aAAa,CAAC,MAAM,EAAE;IAClF8B,SAAS,KAAAP,MAAA,CAAK9B,WAAW;EAC3B,CAAC,EAAEU,KAAK,CAACiC,KAAK,EAAEjC,KAAK,CAACgC,SAAS,IAAItD,KAAK,CAACmB,aAAa,CAAC,KAAK,EAAE;IAC5D8B,SAAS,KAAAP,MAAA,CAAK9B,WAAW,WAAQ;IACjC4C,OAAO,EAAE,SAAAA,QAAA,EAAM;MACb,IAAIC,EAAE;MACN5B,UAAU,CAAC,KAAK,CAAC;MACjB,CAAC4B,EAAE,GAAGnC,KAAK,CAACoC,OAAO,MAAM,IAAI,IAAID,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACE,IAAI,CAACrC,KAAK,CAAC;IAC1E;EACF,CAAC,EAAEtB,KAAK,CAACmB,aAAa,CAACd,YAAY,EAAE;IACnC4C,SAAS,KAAAP,MAAA,CAAK9B,WAAW;EAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACR,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}